<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Hello World JS with KietHo1</h1>
  </body>
  <script>
    //...copy
    let arr1 = [1, 2, 3, 4, 5];
    let state = {
      name: "KietHo1",
      address: "HCM city",
      channel: "LovelyHo",
    };

    console.log();

    /* let name = state.name;
    let address = state.address;
    let channel = state.channel */

    /* let{name, address, channel} = state; */

    //const [name, setName] = useState('')
    let arr = ["KietHo1", "LovelyHo"];
    let [name, channel] = arr;
    console.log(">>> check key: ", name, channel);

    $.support.cors = true;
    const callback = (error, data) => {
      if (data) {
        console.log("calling callback with data: ", data);
      }
      if (error) {
        console.log("calling callback with error: ", error);
      }
    };
    function getMySchoolInfo(id, callback) {
      //Promise
      return new Promise((resolve, reject) => {
        var request = new XMLHttpRequest();
        request.onreadystatechange = function () {
          if (this.readyState == 4 && request.status == 200) {
            // Typical action to be performed when the document is ready:
            const data = JSON.parse(request.responseText);
            const dataString = JSON.stringify(data);
            resolve(data);
            /* callback(undefined, data); */
            /* callback(undefined, dataString);
            callback(undefined, request.responseText); */
          }
          if (this.readyState === 4 && request.status !== 200) {
            /* callback("Something wrongs", undefined); */
            reject("something wrong wit id: " + id);
          }
        };
        request.open(
          "GET",
          `https://jsonplaceholder.typicode.com/todos/${id}`,
          true
        );
        request.withCredentials = true; //Update this code
        request.send();
      });
    }
    //Add async and await
    const getNewMySchoolInfo = async (id) => {
      try {
        let response = await fetch(
          `https://jsonplaceholder.typicode.com/todos/${id}`
        );
        if (response && response.status !== 200) {
          //Add if
          throw new Error(
            "Something wrong with status code: " + response.status
          );
        }
        let data = await response.json();
        return data; //resolve
      } catch (e) {
        //Add catch
        console.log(">>> check catch error: ", e.message);
      }
    };
    getNewMySchoolInfo(2)
      .then((data) => {
        console.log(">>> check get data: ", data);
      })
      .catch((err) => {
        console.log(">>> check error: ", err.message);
      });
    //Add fetch
    /* fetch(`https://jsonplaceholder.typicode.com/todos/1`)
      .then((Response) => {
        return (data1 = data.json());
      })
      .then((data) => {
        console.log(">>> check fetch data: ", data);
      }); */
    /* getMySchoolInfo(1)
      .then((data1) => {
        console.log(">> get data 1: ", data1);
        return getMySchoolInfo(2);
      })
      .then((data2) => {
        console.log(">>> get data 2: ", data2);
        return getMySchoolInfo(3);
      })
      .then((data3) => {
        console.log(">>> get data 3: ", data3);
      })
      .catch((err) => {
        console.log(">>> ", err);
      }); */

    /* getMySchoolInfo(1)
      .then((data) => {
        console.log(">> get data: ", data);

        getMySchoolInfo(2).then((data) => {
          console.log(">> get data 2: ", data);
        });
      })
      .catch((err) => {
        console.log(">>> ", err);
      }); */
    /* getMySchoolInfo(1, (error, data) => {
      if (data) {
        console.log("calling callback with data: ", data);
      }
      if (error) {
        console.log("calling callback with error: ", error);
        getMySchoolInfo(2, () => {
          if (data) {
            console.log("calling callback with data: ", data);
            getMySchoolInfo(3, (error, data) => {
              if (data) {
                console.log("calling callback with data: ", data);
              }
              if (error) {
                console.log("calling callback with error: ", error);
              }
            });
          }
          if (error) {
            console.log("calling callback with error: ", error);
          }
        });
      }
    }); */

    //promise example

    const promiseExp = () => {
      //Promise
      return new Promise((resolve, reject) => {
        resolve({ name: "KietHo1", channel: "Kiet Ho" });
        reject("something wrong");
      });
    };
    /* promiseExp()
      .then((data) => { //then là resolve
        console.log(data);
      })
      .catch((error) => { //catch là reject
        console.log(error);
      }); */
  </script>
</html>
